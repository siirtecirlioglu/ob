{"version":3,"sources":["./src/app/orderbook-table/orderbook-table.component.ts","./src/app/orderbook-table/orderbook-table.component.html","./src/environments/environment.ts","./src/app/models/book-feeds.ts","./src/app/services/notification.service.ts","./src/app/app.component.ts","./src/app/app.component.html","./src/app/app.module.ts","./src/app/services/futures.service.ts","./src/app/models/futures-pairs.model.ts","./src/app/processors/futures-data.processor.ts","./src/app/app-routing.module.ts","./src/app/services/crypto.service.ts","./src/main.ts","./$_lazy_route_resource lazy namespace object"],"names":[],"mappings":"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","file":"main.js","sourcesContent":["import { Component, OnInit } from '@angular/core';\nimport { FuturesPairs } from '../models/futures-pairs.model';\nimport { FuturesService } from '../services/futures.service';\nimport { switchMap } from 'rxjs/operators';\nimport { FuturesDataProcessor } from '../processors/futures-data.processor';\nimport { Observable, of } from 'rxjs';\nimport { Orderbook } from '../models/orderbook.model';\n\n@Component({\n  selector: 'app-orderbook-table',\n  templateUrl: './orderbook-table.component.html',\n  styleUrls: ['./orderbook-table.component.scss']\n})\nexport class OrderbookTableComponent implements OnInit {\n\n  orderbookData$: Observable<Orderbook> = of();\n\n  // TODO Potentially can accept an interface of a service so that the orderbook table can be more reusable\n  constructor(private futuresService: FuturesService,\n              private futuresDataProcessor: FuturesDataProcessor) { }\n\n  ngOnInit(): void {\n    this.orderbookData$ = this.futuresService.getFutures(FuturesPairs.XBT_USD).pipe(\n      switchMap(data => of(this.futuresDataProcessor.process(data))),\n    );\n  }\n\n}\n","<div class=\"orderbook-table\">\n\n    <div class=\"orderbook-table__container\"\n        *ngIf=\"(orderbookData$ | async) as orderbookData; else loading\">\n        \n        <!-- TODO This can be a component on its own and perhaps this component can be better named -->\n        <div class=\"orderbook-table--asks\">\n            <h2 class=\"orderbook-table__header\">\n                Asks\n            </h2>\n            <div class=\"orderbook-table__table\">\n                <table>\n                    <tr class=\"orderbook-table__table-header\">\n                        <th>Price</th>\n                        <th>Size</th>\n                        <th>Total</th>\n                    </tr>\n                    <tr class=\"orderbook-table__table-values\"\n                        *ngFor=\"let ask of orderbookData.asks\">\n                        <td>{{ask.price}}</td>\n                        <td>{{ask.size}}</td>\n                        <td>{{ask.total}}</td>\n                    </tr>\n                </table>\n            </div>\n        </div>\n\n        <div class=\"orderbook-table--bids\">\n            <h2 class=\"orderbook-table__header\">\n                Bids\n            </h2>\n            <div class=\"orderbook-table__table\">\n                <table>\n                    <tr class=\"orderbook-table__table-header\">\n                        <th>Price</th>\n                        <th>Size</th>\n                        <th>Total</th>\n                    </tr>\n                    <tr class=\"orderbook-table__table-values\"\n                        *ngFor=\"let bid of orderbookData.bids\">\n                        <td>{{bid.price}}</td>\n                        <td>{{bid.size}}</td>\n                        <td>{{bid.total}}</td>\n                    </tr>\n                </table>\n            </div>\n        </div>\n\n    </div>\n    \n\n    <ng-template #loading>\n        Loading...\n    </ng-template>\n</div>","// This file can be replaced during build by using the `fileReplacements` array.\n// `ng build --prod` replaces `environment.ts` with `environment.prod.ts`.\n// The list of file replacements can be found in `angular.json`.\n\nexport const environment = {\n  production: false\n};\n\n/*\n * For easier debugging in development mode, you can import the following file\n * to ignore zone related error stack frames such as `zone.run`, `zoneDelegate.invokeTask`.\n *\n * This import should be commented out in production mode because it will have a negative impact\n * on performance if an error is thrown.\n */\n// import 'zone.js/dist/zone-error';  // Included with Angular CLI.\n","export const BookFeedIds = {\n    FUTURES: 'book_ui_1'\n};\n\nexport const BookFeedSnapshotIds = {\n    FUTURES: `${BookFeedIds.FUTURES}_snapshot`\n};\n","import { Injectable } from '@angular/core';\nimport { BehaviorSubject, Observable, of } from 'rxjs';\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class NotificationService {\n\n    private notifications$ = new BehaviorSubject<string | undefined>(undefined);\n\n    notify(data: string | undefined): void {\n        this.notifications$.next(data);\n    }\n\n    getNotifications(): Observable<string | undefined> {\n        return this.notifications$;\n    }\n\n}\n","import { Component, OnInit } from '@angular/core';\nimport { ActivatedRoute } from '@angular/router';\nimport { Observable, of } from 'rxjs';\nimport { NotificationService } from './services/notification.service';\n\n@Component({\n  selector: 'app-root',\n  templateUrl: './app.component.html',\n  styleUrls: ['./app.component.scss']\n})\nexport class AppComponent implements OnInit {\n  title = 'orderbook';\n\n  notifications$: Observable<string | undefined> = of();\n  productId = 'XBT-USD'; // TODO I'd normally want to get this from the URL param map\n\n  constructor(private notificationService: NotificationService,\n              private route: ActivatedRoute) {\n  }\n\n  ngOnInit(): void {\n    this.notifications$ = this.notificationService.getNotifications();\n  }\n\n}\n","<header class=\"app-header\">\n    <div class=\"app-header--title\">\n      Orderbook\n    </div>\n    <div class=\"app-header--details\">{{productId}}</div>\n</header>\n<router-outlet></router-outlet>\n<!-- <app-orderbook-table></app-orderbook-table> -->\n<footer class=\"app-footer\">\n  <div class=\"app-copyright\">This was built by Siir Tecirlioglu in 2021</div>\n</footer>","import { NgModule } from '@angular/core';\nimport { BrowserModule } from '@angular/platform-browser';\nimport { BrowserAnimationsModule } from '@angular/platform-browser/animations';\n\nimport { AppRoutingModule } from './app-routing.module';\nimport { AppComponent } from './app.component';\nimport { OrderbookTableComponent } from './orderbook-table/orderbook-table.component';\nimport { NotificationService } from './services/notification.service';\n\n@NgModule({\n  declarations: [\n    AppComponent,\n    OrderbookTableComponent\n  ],\n  imports: [\n    BrowserModule,\n    AppRoutingModule,\n    BrowserAnimationsModule,\n  ],\n  providers: [\n    NotificationService,\n  ],\n  bootstrap: [AppComponent]\n})\nexport class AppModule { }\n","import { Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { catchError, filter } from 'rxjs/operators';\nimport { BookFeedIds, BookFeedSnapshotIds } from '../models/book-feeds';\nimport { CryptoData, CryptoDataRequest, CryptoSnapshotData } from '../models/crypto-data.model';\nimport { FuturesPairs, FuturesProductIds } from '../models/futures-pairs.model';\nimport { CryptoService } from './crypto.service';\nimport { NotificationService } from './notification.service';\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class FuturesService {\n\n    constructor(private cryptoService: CryptoService,\n                private notificationService: NotificationService) {\n        this.cryptoService.connect();\n    }\n\n    // TODO Only works with 1 future pair. Can be extended.\n    public getFutures(futurePair: FuturesPairs): Observable<CryptoData | CryptoSnapshotData> {\n        const productId = FuturesProductIds[futurePair];\n        const message: CryptoDataRequest = {\n            event: 'subscribe',\n            feed: BookFeedIds.FUTURES,\n            product_ids: [productId]\n        };\n\n        return this.cryptoService.sendMessage(message).pipe(\n            filter(data => data.product_id === productId),\n            catchError((error) => {\n                this.notificationService.notify(`Something went wrong while getting orderbook data for book feed[${BookFeedIds.FUTURES}] and product id[${productId}]: ${error}`);\n                return [];\n            })\n        );\n    }\n\n}\n","export enum FuturesPairs {\n    XBT_USD = 'XBT_USD',\n}\n\nexport const FuturesProductIds = {\n    [FuturesPairs.XBT_USD]: 'PI_XBTUSD'\n};\n","import { Injectable } from '@angular/core';\nimport { BookFeedIds, BookFeedSnapshotIds } from '../models/book-feeds';\nimport { CryptoData, CryptoOrder, CryptoSnapshotData } from '../models/crypto-data.model';\nimport { Order, Orderbook } from '../models/orderbook.model';\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class FuturesDataProcessor {\n\n    private orderbook: Orderbook = { bids: [], asks: [], levels: 0 };\n\n    public process(data: CryptoData | CryptoSnapshotData): Orderbook {\n        if (data.feed === BookFeedSnapshotIds.FUTURES) {\n            this.orderbook.asks = this.processNewOrders(data.asks);\n            this.orderbook.bids = this.processNewOrders(data.bids);\n            this.orderbook.levels = (data as CryptoSnapshotData).numLevels;\n        } else if (data.feed === BookFeedIds.FUTURES) {\n            this.processUpdates(data.asks, this.orderbook.asks, 'ASK');\n            this.processUpdates(data.bids, this.orderbook.bids, 'BID');\n        }\n\n        const maxLevels = this.orderbook.levels || 100;\n\n        const limitedOrderbook: Orderbook = {\n            asks: this.orderbook.asks.slice(0, Math.min(maxLevels, this.orderbook.asks.length)),\n            bids: this.orderbook.bids.slice(0, Math.min(maxLevels, this.orderbook.bids.length))\n        };\n\n        return limitedOrderbook;\n    }\n\n    private processNewOrders(orders: CryptoOrder[]): Order[] {\n        let total = 0;\n        return orders.map((order: CryptoOrder) => {\n            const size = order[1];\n            total += size;\n            return {\n                price: order[0],\n                size,\n                total\n            };\n        });\n    }\n\n    private processUpdates(orders: CryptoOrder[], orderbookOrders: Order[], type: 'ASK' | 'BID'): void {\n        orders.forEach((order: CryptoOrder) => {\n            const price = order[0];\n            const size = order[1];\n            const orderToUpdate = orderbookOrders.findIndex(o => o.price === price);\n            const oldSize = orderbookOrders[orderToUpdate]?.size;\n\n            if (size === 0 && orderToUpdate > -1) {\n                this.updateTotals(orderToUpdate, -oldSize, orderbookOrders);\n                orderbookOrders.splice(orderToUpdate, 1);\n            } else if (size !== 0) {\n                if (orderToUpdate > -1) {\n                    const amountDif = size - oldSize;\n                    orderbookOrders[orderToUpdate].size = size;\n                    this.updateTotals(orderToUpdate, amountDif, orderbookOrders);\n                } else {\n                    for (let i = 0; i <= orderbookOrders.length; i++) {\n                        if (type === 'ASK') {\n                            if (i === orderbookOrders.length || price < orderbookOrders[i].price) {\n                                this.insertOrder(i, price, size, orderbookOrders);\n                                this.updateTotals(i + 1, size, orderbookOrders);\n                                break;\n                            }\n                        } else {\n                            if (i === orderbookOrders.length || price > orderbookOrders[i].price) {\n                                this.insertOrder(i, price, size, orderbookOrders);\n                                this.updateTotals(i + 1, size, orderbookOrders);\n                                break;\n                            }\n                        }\n                    }\n                }\n            }\n        });\n    }\n\n    private insertOrder(index: number, price: number, size: number, orderbookOrders: Order[]): void {\n        orderbookOrders.splice(index, 0, {\n            price,\n            size,\n            total: (orderbookOrders[index - 1]?.total ?? 0) + size\n        });\n    }\n\n    private updateTotals(startingIndex: number, difference: number, orderbookOrders: Order[]): void {\n        for (let i = startingIndex; i >= 0 && i < orderbookOrders.length; i++) {\n            orderbookOrders[i].total += difference;\n        }\n    }\n\n}\n","import { NgModule } from '@angular/core';\nimport { RouterModule, Routes } from '@angular/router';\nimport { OrderbookTableComponent } from './orderbook-table/orderbook-table.component';\n\nconst routes: Routes = [\n  { path: '', component: OrderbookTableComponent }\n];\n\n@NgModule({\n  imports: [RouterModule.forRoot(routes)],\n  exports: [RouterModule]\n})\nexport class AppRoutingModule { }\n","import { Injectable, OnDestroy } from '@angular/core';\n\nimport { webSocket, WebSocketSubject } from 'rxjs/webSocket';\nimport { Observable, throwError } from 'rxjs';\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class CryptoService implements OnDestroy {\n\n    private readonly WS_API_URL = 'wss://www.cryptofacilities.com/ws/v1';\n    private readonly RETRY_DELAY = 10;\n\n    private connection$: WebSocketSubject<any> | undefined;\n\n    public connect(): void {\n        if (!this.connection$) {\n            this.connection$ = webSocket(this.WS_API_URL);\n        }\n    }\n\n    public sendMessage(data: any): Observable<any> {\n        if (this.connection$) {\n            const payload = {...data};\n            this.connection$.next(payload);\n            return this.connection$;\n        } else {\n            return throwError('Nothing to send message to. Open the connection first.');\n        }\n    }\n\n    public closeConnection(): void {\n        if (this.connection$) {\n            this.connection$.complete();\n            this.connection$ = undefined;\n        } else {\n            console.log('Nothing to close. Open the connection first.');\n        }\n    }\n\n    ngOnDestroy(): void {\n        this.closeConnection();\n    }\n\n}\n","import { enableProdMode } from '@angular/core';\nimport { platformBrowserDynamic } from '@angular/platform-browser-dynamic';\n\nimport { AppModule } from './app/app.module';\nimport { environment } from './environments/environment';\n\nif (environment.production) {\n  enableProdMode();\n}\n\nplatformBrowserDynamic().bootstrapModule(AppModule)\n  .catch(err => console.error(err));\n","function webpackEmptyAsyncContext(req) {\n\t// Here Promise.resolve().then() is used instead of new Promise() to prevent\n\t// uncaught exception popping up in devtools\n\treturn Promise.resolve().then(function() {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t});\n}\nwebpackEmptyAsyncContext.keys = function() { return []; };\nwebpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;\nmodule.exports = webpackEmptyAsyncContext;\nwebpackEmptyAsyncContext.id = \"zn8P\";"],"sourceRoot":"webpack:///"}